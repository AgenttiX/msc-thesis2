In this thesis the gravitational wave spectrum from the first order phase transition is calculated using the Sound Shell Model.
The conversion from the fluid velocity and enthalpy profiles of chapter \ref{ch:phase_transitions} to the gravitational wave spectra
is a process that involves multiple steps.
First in section \ref{gw_production} we investigate how the gravitational wave spectrum is produced by the shear stress.
Then in section \ref{shear_stress} we investigate how the shear stress is produced by the sound waves.
We combine these results in section \ref{gw_from_sound_waves} to see how the gravitational wave spectrum is produced by sound waves.
Then in section \ref{sound_shell_model} we introduce the Sound Shell model to generate the sound waves from the fluid velocity profiles of chapter \ref{ch:phase_transitions}.
Combining these, we have the gravitational wave spectra.
These four sections follow the contents and structure in the article \cite{hindmarsh_gw_pt_2019} that introduces the Sound Shell Model.
In section \ref{omgw0} we convert these to the frequencies today.
Then in section \ref{correction_factors} we apply correction factors to improve upon the results of the previous chapters.
Finally in section \ref{noise} we define the LISA instrument noise to compare the signal-to-noise ratios of the gravitational wave spectra to the LISA instrument noise.


\section{Gravitational wave production from shear stress}
\label{gw_production}
In this section we derive how the gravitational wave spectrum $\mathcal{P}_\text{gw}$ is produced by the shear stress correlator $U_\pi$.
First of all we assume that the time scale of the phase transition is much shorter than the Hubble time.
Therefore we can neglect the expansion of the universe and assume that the background is Minkowski spacetime.
The fluid and the scalar field are sources of metric perturbations for the spacetime.
In the synchronous gauge these produce a change in the space-time interval
\cite[p. 7]{hindmarsh_gw_pt_2019}
\begin{equation}
ds^2 = -dt^2 + (\delta_{ij} + h_{ij}) dx^i dx^j.
\end{equation}
The metric perturbations $h_{ij}$ are sourced by shear stress,
which is the transverse-traceless part of the energy-momentum tensor $\Pi_{ij}$ of eq. \eqref{eq:ep_tensor_general_matrix}.
This results in a wave equation for $h_{ij}$ with a source term,
\cites[eq. 3.1]{hindmarsh_gw_pt_2019}[eq. 1.24]{maggiore_gw_2008}
% (similar to \eqref{eq:wave_equation})
\begin{equation}
\ddot{h}_{ij} - \nabla^2 h_{ij} = 16 \pi G \Pi_{ij}.
\end{equation}
The energy-momentum tensor $T_{ij}$ consists of contributions from the fluid and the scalar field \cite[p. 7]{hindmarsh_gw_pt_2019}
\begin{align}
T^f_{ij}    &= (e+p) \gamma^2 v_i v_j + p \delta_{ij}, \\
T^\phi_{ij} &= \delta_i \phi \delta_j \phi - \frac{1}{2}(\delta \phi)^2 \delta_{ij}.
\end{align}

% Defining P and Lambda tensors
Let us introduce the tensor
\cite[eq. 1.35]{maggiore_gw_2008}
\begin{equation}
P_{ij}(\bm{k}) = \delta_{ij} - \hat{k}_i \hat{k}_j.
\end{equation}
This tensor is symmetric, transverse ($\hat{k}_i P_{ij}(\bm{k}) = 0$) and a projector ($P_{ik}P_{kj} = P_{ij}$), and its trace $P_{ii} = 2$.
Using $P_{ij}$ we can construct another tensor that we call the $\Lambda$ tensor
\cite[eq. 1.36]{maggiore_gw_2008}
\begin{equation}
\Lambda_{ij,kl}(\bm{k}) = P_{ik}(\bm{k}) P_{jl}(\bm{k}) - \frac{1}{2} P_{ij}(\bm{k}) P_{kl}(\bm{k}).
\label{eq:Lambda}
\end{equation}
\iffalse
This is still a projector, in the sense that
\begin{equation}
\Lambda_{ij,kl} \Lambda_{kl,mn} = \Lambda_{ij,mn}.
\end{equation}
It is also transverse on all of its indices as $n^i \Lambda_{ij,kl} = 0$ for all indices ($ijkl$}.
It is traceless with respect to the ($i,j$) and ($k,l$) index pairs,
\begin{equation}
\Lambda_{ii,kl} = \Lambda_{ij,kk} = 0.
\end{equation}
\fi
For further details on the $\Lambda$ tensor, please see
\cite[ch. 1.2]{maggiore_gw_2008}.

% Defining P_\dot{h}
The spectral density of the time derivative of the perturbations, $P_{\dot{h}}(\bm{k},t)$, is defined by
\cite[eq. 3.4]{hindmarsh_gw_pt_2019}
\begin{equation}
\langle \dot{h}_{\bm{k}}^{ij}(t) \dot{h}_{\bm{k}'}^{ij}(t) \rangle = P_{\dot{h}}(\bm{k},t) (2\pi)^3 \delta (\bm{k} + \bm{k}').
\label{eq:hbracket}
\end{equation}

% Defining e_{gw}, e_c and Omega_gw
The energy density of gravitational waves is given by
\cites[eq. 3.3]{hindmarsh_gw_pt_2019}[eq. 1.135, 7.193]{maggiore_gw_2008}
\begin{align}
e_{gw}
&= \frac{1}{32 \pi G} \int dk^3 \langle \dot{h}_{ij} \dot{h}_{ij} \rangle \\
&= \frac{1}{32 \pi G} \int dk \frac{k^2}{2 \pi^2} P_{\dot{h}}(k).
\end{align}
In many textbooks and articles the integral in the first expression is implicit.
The factor of $\frac{k^2}{2\pi^2}$ results from the conversion to spherical coordinates.
The critical energy density corresponding to a flat universe is given by
\cite[eq. 7.196]{maggiore_gw_2008}
\begin{equation}
e_c = \frac{3 H^2}{8 \pi G}.
\label{eq:e_crit}
\end{equation}
Let us define energy density of gravitational waves relative to the critical energy density.
This is the dimensionless quantity
\begin{equation}
\Omega_{gw} \equiv \frac{e_{gw}}{e_c}.
\label{eq:omega_gw}
\end{equation}
% This will be needed later in eq. \eqref{eq:gw_pow_spec}.

% GW power spectrum. Uses Omega, so this is in the correct place.
The gravitational wave power spectrum is defined by
\cite[eq. 3.45]{hindmarsh_gw_pt_2019}
\begin{equation}
\mathcal{P}_{gw}(k)
\equiv \frac{d \Omega_{gw}}{d \ln (k)}
% = \frac{1}{\bar{\rho}} \frac{1}{32 \pi G} \mathcal{P}_{\dot{h}}(k)
= \frac{1}{12 H^2} \frac{k^3}{2\pi} P_{\dot{h}}(k)
= \frac{1}{12 H^2} \mathcal{P}_{\dot{h}}(k),
\label{eq:gw_pow_spec}
\end{equation}
where the first step comes directly using the equations above.
It should be noted that in \cite[eq. 3.6, eq. 3.46]{hindmarsh_gw_pt_2019} it is presumed that $\bar{\rho}=e_c$.
A spectral density can be converted to a power spectrum with
\cite[eq. 4.18]{hindmarsh_gw_pt_2019}
\begin{equation}
\mathcal{P}(k) = \textcolor{gray}{(2)} \frac{k^3}{2 \pi^2} P(k).
\label{eq:pow_spec}
\end{equation}
The factor of two is due to the fact that the velocity Fourier transform includes waves moving in both directions.
\footnote{See also \cite[p. 338]{maggiore_gw_2008}.}
Whether it's included or not is dependent on the context.
Therefore, the gravitational wave power spectrum can be obtained from the spectral density $P_\dot{h}$ as
\begin{equation}
\mathcal{P}_{gw}(k) = \frac{1}{12 H^2} \frac{k^3}{2\pi^2} P_{\dot{h}}.
\label{eq:gw_pow_spec2}
\end{equation}
To obtain the gravitational wave spectrum $\mathcal{P}_{gw}(k)$,
we therefore need to obtain an expression for $P_\dot{h}$ that we can compute from the fluid shell profile.
For this we will need quite a few similar intermediate quantities.
To avoid confusion, their symbols and names are listed in table \ref{table:symbols}.

% This is here, since the first P has just been introduced.
\begin{table}[ht]
\caption{Symbols and explanations of the spectral quantities}
\begin{tabular}{l|l|l}
Symbol & Explanation & Eq.\\
\hline
$P_{\dot{h}}$ & Spectral density of $\dot{h}$ & \eqref{eq:p_dot_h} \\
$P_v$ & Spec. den. of the plane wave components of the velocity field & \eqref{eq:spec_den_v} \\
% $P_{\tilde{v}}$ & Spec. den. of the Fourier transformation of the velocity field & \eqref{eq:p_tilde_v} \\
$\tilde{P}_v$ & Scaled velocity spectral density & \eqref{eq:tilde_p_v} \\
$\mathcal{P}_{\tilde{v}}$ & Velocity power spectrum & \eqref{eq:pow_v} \\
$\tilde{P}_\text{gw}$ & Spectral density of the gravitational wave power spectrum & \eqref{eq:spectral_density} \\
% $\mathcal{P}_v$ & ??? \\
$\mathcal{P}_\text{gw}$ & Gravitational wave power spectrum & \eqref{eq:pow_gw} \\
$\dot{P}_{\dot{h}}$ & Growth rate of the spectral density of $\dot{h}$ & \eqref{eq:dot_p_dot_h} \\
$\mathcal{P}'_{\text{gw}}$ & Growth rate of the GW spectrum relative to the Hubble rate & \eqref{eq:pow_gw_prime}
\end{tabular}
\label{table:symbols}
\end{table}

There exists a solution to the gravitational wave equation in the form of
\cite[eq. 3.2]{hindmarsh_gw_pt_2019}
\begin{equation}
h_{ij} (\bm{k},t) = (16 \pi G) \Lambda_{ij,kl}(\bm{k}) \int_0^t dt' \frac{\sin [k(t-t')]}{k} T_{kl}(\bm{k},t').
\label{eq:h_ij}
\end{equation}
Since we are operating in the transverse-traceless gauge, it is sufficient to replace $T_{ij}$ with the tensor
\cite[eq. 3.7]{hindmarsh_gw_pt_2019}
\begin{equation}
\tau_{ij} = \gamma^2 w v_i v_j + \partial_ \phi \partial_j \phi.
\label{eq:tau_ij}
\end{equation}
This will be approximated in eq. \eqref{eq:tau_ij_approx}.
Using eq. \eqref{eq:h_ij} and \eqref{eq:tau_ij} we have
\cite[eq. 3.8]{hindmarsh_gw_pt_2019}
\begin{multline}
\langle \dot{h}_{\bm{k}_1}^{ij}(t) \dot{h}_{\bm{k}_2}^{ij}(t) \rangle \\
= (16 \pi G)^2 \int_0^t dt_1 dt_2 \cos [k_1(t-t_1)] \cos [k_2(t-t_2)] \Lambda_{ij,kl}(\bm{k})
\langle \tau_{\bm{k}_1}^{ij}(t_1) \tau_{\bm{k}_2}^{kl}(t_2) \rangle
\end{multline}
Let us define the unequal time correlator (UETC) of the fluid shear stress $U_\Pi$ with
\cite[eq. 3.9]{hindmarsh_gw_pt_2019}
\begin{equation}
\Lambda_{ij,kl}(\bm{k}) \langle \tau_{\bm{k}_1}^{ij}(t_1) \tau_{\bm{k}_2}^{kl}(t_2) \rangle
= U_\Pi (k_1, t_1, t_2) (2 \pi)^3 \delta(\bm{k}_1 + \bm{k}_2).
\label{eq:hbracket2}
\end{equation}
Using this we can make a simple substitutions to eq. \eqref{eq:hbracket} and \eqref{eq:hbracket2},
resulting in an expression for the spectral density as
\cite[eq. 3.10]{hindmarsh_gw_pt_2019}
\begin{equation}
P_{\dot{h}} (k,t) = (16 \pi G)^2 \int_0^t dt_1 \int_0^t dt_2 \cos [k(t-t_1)] \cos [k(t-t_2)] U_\Pi (k, t_1, t_2).
\label{eq:p_dot_h}
\end{equation}
Averaging over oscillations at wavenumber $k$,
\begin{equation}
P_{\dot{h}} (k,t) = (16 pi G)^2 \frac{1}{2} \int_0^t dt_1 \int_0^t dt_2 \cos \left( k(t_1 - t_2) \right) U_\Pi (k, t_1, t_2).
\label{eq:p_dot_h_avg}
\end{equation}
This way we can compute the gravitational wave spectrum $\mathcal{P}_\text{gw}$ from the fluid shear stress UETC $U_\Pi$.


\section{Shear stress from sound waves}
\label{shear_stress}
In this section we investigate how the unequal time correlator for the shear stress (UETC) can be computed from the sound waves in the fluid.
Let us start by defining the fluid stress-energy tensor $\tau_ij$.
The $\partial_i \phi \partial_j \phi$ term of eq. \eqref{eq:tau_ij} is non-zero only at the phase bondary,
which is thin and therefore negligible compared to the fluid shell.
We also approximate that once the bubbles have collided and merged,
the enthalpy is constant throughout the fluid shell $w = e + p \approx \bar{w}$
and that the fluid velocities are non-relativistic, resulting in $\gamma(v) = 1$.
Therefore eq. \eqref{eq:tau_ij} approximates as
\cite[eq. 3.12]{hindmarsh_gw_pt_2019}
\begin{equation}
\tau_{ij} \approx \bar{w} v_i v_j.
\label{eq:tau_ij_approx}
\end{equation}

Let us define a couple of mathematical tools and quantities.
The difference of the wavevectors $\mathbb{q}$ and $\mathbb{k}$,
\begin{equation}
\tilde{\mathbb{q}} = \mathbb{q} - \mathbb{k}.
\label{eq:tilde_q}
\end{equation}
Using this their product can be expressed as
\begin{equation}
\mu \equiv \hat{\mathbb{q}} \cdot \hat{\mathbb{k}} = \frac{q^2 + k^2 - \tilde{q}^2}{2kq}.
\label{eq:mu}
\end{equation}
The length of a vector is denoted as
\begin{equation}
q \equiv |\mathbb{q}|.
\end{equation}
The unit vectors are defined as
\begin{equation}
\hat{\mathbb{q}} \equiv \frac{\mathbb{q}}{|\mathbb{q}|} \Rightarrow
\hat{q}^i \equiv \frac{q^i}{q}.
\end{equation}
The angular frequencies $\omega$ and $\tilde{\omega}$ are defined as
\cite[p. 10]{hindmarsh_gw_pt_2019}
\begin{equation}
\omega = c_s q, \quad \tilde{\omega} = c_s \tilde{q}.
\end{equation}
The $\Lambda$ tensor of eq. \eqref{eq:Lambda} has the property that
\cite[eq. 3.17]{hindmarsh_gw_pt_2019}
\begin{equation}
\Lambda_{ij,kl}(\mathbb{k}) \hat{q}^i \hat{\tilde{q}}^j \hat{\tilde{q}}^k \hat{q}^l = \frac{1}{2}(1 - \mu^2)^2 \frac{q^2}{\tilde{q}^2}.
\end{equation}
For later use let us also define
\cite[p. 11]{hindmarsh_gw_pt_2019}
\begin{equation}
t_+ \equiv \frac{t_1 + t_2}{2}, \quad t_- \equiv t_1 - t_2.
\label{eq:t_plus_minus}
\end{equation}

\iffalse
The Fourier transformation of the velocity field can be denoted as
\cite[eq. 3.13]{hindmarsh_gw_pt_2019}
\begin{equation}
\tilde{v}_\mathbb{q}^i(t) = \int d^3 xv^i (\mathbb{x},t) e^{-i \mathbb{q} \cdot \mathbb{x}}.
\end{equation}
We use the same result as in \cite{hindmarsh_gw_pt_2019} that the velocity field is irrotational and statistically homogenous,
and the two-point function $G$ can therefore be written as
\begin{equation}
\langle \tilde{v}_{\mathbb{q}_1}^i (t_1) \tilde{v}_{\mathbb{q}_2}^{*j} (t2) \rangle = \hat{q}_1^i \hat{q}_2^j G(q_1, t_1, t_2) (2\pi)^3 \delta(\mathbb{q_1} - \mathbb{q_2}).
\end{equation}
The leading term for the shear stress UETC of eq. \eqref{eq:uetc_final} is therefore
\fi

Using these tools Hindmarsh et al. have derived in \cite{hindmarsh_gw_pt_2019} that the UETC can be given as
\cite[eq. 3.32]{hindmarsh_gw_pt_2019}
\begin{equation}
U_\Pi(k, t_1, t_2) = 4 \bar{w}^2 \int \frac{d^3 q}{(2\pi)^3} \frac{q^2}{\tilde{q}^2} (1 - \mu^2) P_v(q) P_v(\tilde{q}) \cos (\omega t_-) \cos (\tilde{\omega} t_-)
\end{equation}
Further by performing an angular integration and changing the integration variable using eq. \eqref{eq:mu} we have
\cite[eq. 3.34]{hindmarsh_gw_pt_2019}
\begin{equation}
U_\Pi (k, t_1, t_2) = \frac{4 \bar{w}^2}{4 \pi^2 k} \int_0^\infty \int_{|q-k|}^{q+k} d\tilde{q} q \tilde{q}
\frac{q^2}{\tilde{q}^2} (1-\mu^2)^2
P_v(q) P_v(\tilde{q})
\cos (\omega t_-) \cos (\tilde{\omega} t_-)
\label{eq:uetc_final}
\end{equation}
The contents of $P_v(q)$ will be defined later in eq. \eqref{eq:spec_den_v}.


\section{Gravitational wave power spectrum from sound waves}
\label{gw_from_sound_waves}
In this section we derive the gravitational wave spectrum from the unequal time correlator (UETC).
The UETC of eq. \eqref{eq:uetc_final} can be substituted to \eqref{eq:p_dot_h_avg},
resulting in
\cite[eq. 3.35]{hindmarsh_gw_pt_2019}
\begin{equation}
P_{\dot{h}} (k,t) = (16 \pi G)^2 \frac{4 \bar{w}}{4\pi^2 k}
\int_0^\infty dq \int_{|q-k|}^{q+k} d\tilde{q} q \tilde{q} \frac{q^2}{\tilde{q}^2} (1-\mu^2)^2
P_v(q) P_v(\tilde{q}) \Delta(t,k,q,\tilde{q}),
\end{equation}
where
\begin{equation}
\Delta(t,k,q,\tilde{q}) \approx \frac{1}{2} \int_0^t dt_1 \int_0^t dt_2 \cos(kt_-)\cos(\omega t_-)\cos(\tilde{\omega}t_-).
\end{equation}
The approximation comes from averaging over the number of oscillations at wavenumber $k$ in eq. \eqref{eq:p_dot_h_avg},
and $t_-$ is defined in eq. \eqref{eq:t_plus_minus}.
Using eq. \eqref{eq:t_plus_minus} one can also change the integration variable to $t_0$, resulting in
\begin{equation}
\Delta(t,k,q,\tilde{q}) = \frac{1}{2} \int_0^t dt_+ \int_{-2t_+}^{2t_+} dt_- \cos(kt_-) \cos(\omega t_-) \cos(\tilde{\omega} t_-).
\end{equation}
Therefore its growth rate is
\begin{equation}
\dot{\Delta}(t,k,q,\tilde{q}) \equiv \frac{d}{dt} \Delta(t,k,q,\tilde{q}) = \frac{1}{2} \int_{-2t}^{2t} dt_- \cos(kt_-) \cos(\omega t_-) \cos(\tilde{\omega} t_-).
\label{eq:delta_dot}
\end{equation}
Using the trigonometric identity for arbitrary angles $\theta$ and $\phi$,
\begin{equation}
\cos \theta \cos \phi = \frac{1}{2} \left( \cos(\theta + \phi) + \cos(\theta - \phi) \right),
\end{equation}
at large $t$, eq. \eqref{eq:delta_dot} asymptotes to a $\delta$-function as
\begin{equation}
\lim_{t\rightarrow\infty} \dot{\Delta}(t,k,q,\tilde{q}) = \frac{\pi}{8} \Sigma_{\pm\pm\pm} \delta(\pm k \pm \omega \pm \tilde{\omega}).
\end{equation}
\iffalse
\begin{align}
k - \omega - \tilde{\omega} \\
= k - c_s q - c_s \tilde{q} \\
\end{align}
\fi
Of these combinations, only $k - \omega - \tilde{\omega}$ and $-(k - \omega - \tilde{\omega})$ can vanish,
and therefore
\begin{equation}
\lim_{t\rightarrow\infty} \dot{\Delta}(t,k,q,\tilde{q}) = \frac{\pi}{4} \delta (k - \omega - \tilde{\omega}).
\label{eq:delta_dot_lim}
\end{equation}
Inserting this to eq. \eqref{eq:p_dot_h_avg} gives us the asymptotic growth rate of the spectral density
\begin{equation}
\lim_{t \rightarrow \infty} \dot{P}_{\dot{h}}(k,t)
= (16 \pi G)^2 \frac{4 \bar{w}^2}{4 \pi^2 k} \int_0^\infty dq \int_{|q-k|}^{q+k} d\tilde{q} q \tilde{q} \frac{q^2}{\tilde{q}^2} (1 - \mu^2)^2 P_v(q) P_v(\tilde{q}) \frac{\pi}{4}(k - \omega - \tilde{\omega}).
\end{equation}
The $\delta$-function of eq. \eqref{eq:delta_dot_lim} has restricted us to
\begin{equation}
k - \omega - \tilde{\omega} = k - c_s (q - \tilde{q}) = 0,
\end{equation}
and therefore we have
\begin{equation}
\tilde{q} = \frac{k}{c_s} - q.
\label{eq:tilde_q2}
\end{equation}
Using this we can define
\begin{equation}
q_\pm \equiv \frac{k(1 \pm c_s)}{2 c_s}.
\end{equation}
Inserting eq. \eqref{eq:tilde_q2} to \eqref{eq:mu} gives
\begin{equation}
\mu &= \frac{2qc_s - k(1 - c_s^2)}{2qc_s^2}.
\end{equation}
We can now integrate over $q$. Since the expression is no longer time-dependent,
we can denote it as
\begin{equation}
\dot{P}_{\dot{h}}(k) = (16 \pi G)^2 \frac{\bar{w}}{4 \pi k c_s} \int_{q_-}^{q_+} \frac{q^3}{\tilde{q}} (1 - \mu^2)^2 P_v(q) P_v(\tilde{q}).
\label{eq:dot_p_dot_h}
\end{equation}

We can now define the scaled velocity spectral density $\tilde{P}_v$ as
\begin{equation}
\tilde{P}_v (qL_f) \equiv \frac{P_v(q)}{L_f^3 \bar{U}_f^2}
\label{eq:tilde_p_v}
\end{equation}
where $L_f$ is a length scale in the velocity field, and $\bar{U}_f$ is the RMS fluid velocity.
Let us also define the additional quantities
\begin{equation}
y = kL_f, \quad z = qL_f, \quad z_\pm = y \frac{1 \pm c_s}{2 c_s}.
\label{eq:gw_yz}
\end{equation}
Therefore the asymptotic growth rate of the spectral density can be written as
\begin{equation}
\dot{P}_{\dot{h}}(y) =
\left( 16 \pi G \bar{w} \bar{U}_f^2 \right)^2
\frac{L_f^4}{4 \pi y c_s}
\int_{z_-}^{z_+} dz
\frac{z^3}{\frac{y}{c_s} - z}
(1 - \mu^2)^2
\tilde{P}_v (z) \tilde{P}_v \left( \frac{y}{c_s} - z \right).
\end{equation}
The growth rate of the gravitational wave spectrum of eq. \eqref{eq:gw_pow_spec2} relative to the Hubble rate is
\cite[eq. 3.46]{hindmarsh_gw_pt_2019}
\begin{equation}
\mathcal{P}'_{\text{gw}} \equiv \frac{1}{H} \frac{d}{dt} \mathcal{P}_{\text{gw}}
= 3 \left( \Gamma \bar{U}_f^2 \right)^2 (HL_f) \frac{(kL_f)^3}{2 \pi^2} \tilde{P}_{\text{gw}} (kL_f),
\label{eq:pow_gw_prime}
\end{equation}
where we have used the $\Gamma$ of eq. \eqref{eq:mean_adiabatic_index} and $e_c$ of eq. eq. \eqref{eq:e_crit} and approximated that $\bar{e} = e_c$.
We have also used the $y$ and $z$ of eq. \eqref{eq:gw_yz}, and using these we have defined $\tilde{P}_{\text{gw}}$,
the dimensionless spectral density function
\cite[eq. 3.47]{hindmarsh_gw_pt_2019}
\footnote{In \cite{hindmarsh_gw_pt_2019} the $\bar{P}_v$ is a typo and should be $\tilde{P}_v$.}
\begin{equation}
\tilde{P}_\text{gw} (y) = \frac{1}{4\pi yc_s} \left(\frac{1-c_s^2}{c_s^2}\right)^2
\int_{z_-}^{z_+} \frac{dz}{z}
\frac{(z-z_+)^2(z-z_-)^2}{z_+ + z_- - z}
\tilde{P}_v (z) \tilde{P}_v (z_+ + z_- z).
\label{eq:spectral_density}
\end{equation}
To get the total gravitational wave power spectrum for a stationary velocity power spectrum with a lifetime $\tau_v = t - t_0$ is given by
\cite[eq. 3.48]{hindmarsh_gw_pt_2019}
\footnote{In \cite{hindmarsh_gw_pt_2019} the $\tilde{P}_{GW}$ is a typo and should be $\tilde{P}_\text{gw}$.}
\begin{equation}
\Omega_\text{gw}^\text{ssm}
\equiv \mathcal{P}_\text{gw}(k)
= \int_{t_0}^{t} dt H \mathcal{P}'_\text{gw}
= 3 \left( \Gamma \bar{U}_f^2 \right)^2 (H \tau_v)(H L_f) \frac{(kL_f)^3}{2\pi^2} \tilde{P}_\text{gw} (kL_f),
\label{eq:gw_pow_spec3}
\end{equation}
where $\Gamma$ is the mean adiabatic index of eq. \eqref{eq:mean_adiabatic_index}.
This is the equation used by PTtools to compute the gravitational wave spectrum.
The choice of $c_s$ in eq. \eqref{eq:spectral_density} is important and non-trivial,
since beyond the bag model $c_s = c_s(T(w(\xi),\phi(\xi)))$.
Therefore for an enthalpy-dependent sound speed the formula is not exact.
We approximate $c_s$ here as $c_s(T(\bar{w},\phi_b),\phi_b)$,
as $\bar{w}$, the mean enthalpy after the phase transition of eq. \eqref{eq:wbar},
gives a reasonable estimate on the temperature of the fluid.
For the constant sound speed model of section \ref{const_cs} this gives simply $c_{s,b}$.


\section{Sound Shell Model}
\label{sound_shell_model}
The Sound Shell Model is the set of equations that enables the conversion from the fluid shell profile to the fluid velocity power spectrum $\mathcal{P}_\tilde{v}$.
The derivation of the Sound Shell Model is beyond the scope of this thesis and available in \cite{hindmarsh_gw_pt_2019},
but we will quote here the results necessary for computing the fluid velocity power spectrum $\mathcal{P}_\tilde{v}$.
The auxiliary quantity $f(z)$ is defined by
\cite[eq. 4.5]{hindmarsh_gw_pt_2019}
\iffalse
\begin{equation}
f(z) = \int d^3\xi \frac{1}{\xi} v_\text{ip}(\xi) e^{-iz^i \xi^i}
= \frac{4\pi}{z} \int_0^\infty d\xi v_\text{ip}(\xi) \sin(z\xi)
\end{equation}
\fi
\begin{equation}
f(z) = \frac{4\pi}{z} \int_0^\infty d\xi v_\text{ip}(\xi) \sin(z\xi),
\end{equation}
where $v_\text{ip}$ is the velocity profile of a single bubble.
Similarly the auxiliary quantity $l(z)$ is defined by
\cite[eq. 4.8]{hindmarsh_gw_pt_2019}
\begin{align}
l(z) = \frac{4 \pi}{z} \int_0^\infty d\xi \lambda_\text{ip}(\xi) \sin(z\xi),
\end{align}
where $\lambda_\text{ip}$ is the energy fluctuation variable $\lambda$ of eq. \eqref{eq:lambda} for a single bubble.
The integrations over the sines in these functions is the sine transformation of the Sound Shell Model.
These can be combined to
\cite[eq. 4.10]{hindmarsh_gw_pt_2019}
\begin{equation}
A(z) \equiv \frac{1}{2} \left( f'(z) + i c_s l(z) \right),
\end{equation}
where $f'(z) = \frac{d}{dz}f(z)$.
Since $f'$ and $\lambda$ are real,
\cite[eq. 4.11]{hindmarsh_gw_pt_2019}
\begin{equation}
|A(z)|^2 = \frac{1}{4} \left( f'(z)^2 + (c_s l(z))^2 \right).
\end{equation}
Spectral density of the plane wave components of the velocity field is given as
\cite[eq. 4.17]{hindmarsh_gw_pt_2019}
\begin{equation}
P_v(q) = \frac{1}{\beta^6}{R_*^3} \int d\tilde{T} \nu(\tilde{T}) \tilde{T}^6 |A(\frac{\tilde{T}q}{\beta})|^2,
\label{eq:spec_den_v}
\end{equation}
where $R_*$ is the mean bubble separation,
$\beta$ is the nucleation rate parameter,
$\eta(\beta T)$ is the bubble lifetime distribution function,
and $\tilde{T} = \beta T_i$.
Using eq. \eqref{eq:pow_spec} we can convert this to the velocity power spectrum
\cite[eq. 4.18]{hindmarsh_gw_pt_2019}
\begin{equation}
\mathcal{P}_{\tilde{v}}(q)
= 2 \frac{q^3}{2\pi^2} P_v(q)
= \frac{2}{(\beta R_*)^3} \frac{1}{2\pi^2} \left(\frac{1}{\beta}\right)^3
\int d \tilde{T} \eta(\tilde{T}) \tilde{T}^6 \left| A \left( \frac{\tilde{T} q}{\beta} \right) \right|^2.
\label{eq:pow_v}
\end{equation}
This can be inserted to eq. \ref{eq:gw_pow_spec3} to get the gravitational wave spectrum.


\section{Correction factors}
\label{correction_factors}
The Sound Shell Model is an approximation, even though it is a highly useful one.
To improve upon its results, several correction factors can be applied.
Giombi et al. have investigated the effects of changing the sound speed on the gravitational wave power spectrum using analytical calculations.
To implement these corrections, we need the barotropic equation of state parameter
\cite[p. 3]{giombi_cs_2024}
\begin{equation}
\omega(T,\phi) \equiv \frac{p(T,\phi)}{e(T,\phi)}.
\end{equation}
Giombi et al. define the quantity $\nu$, which we shall call as $\nu_\text{gdh2024}$, as
\cite[eq. 2.11]{giombi_cs_2024}
\begin{equation}
\nu_\text{gdh2024} = \frac{1 - 3\omega}{1 + 3\omega}.
\label{eq:nu_gdh2024}
\end{equation}
Giombi et al. use $\frac{\Delta \eta_v}{\eta_*}$ as the source duration,
whereas the flow lifetime $\tau_v$ is a more commonly known quantity.
It is proportional to known quantities as
\cites[p. 3]{hindmarsh_gw_pt_2019}[p. 6]{gowling_lisa_2021}
\begin{equation}
\tau_v \sim \frac{R_*}{\bar{U}_f} \sim \frac{R_*}{\sqrt{K}},
\end{equation}
where $R_*$ is the mean bubble separation, and
$K$ is the kinetic energy fraction of eq. \eqref{eq:kinetic_energy_fraction2},
which can be computed from the fluid shell.
The Hubble-scaled mean bubble spacing is defined as
\cite[eq. 2.2]{gowling_lisa_2021}
\begin{equation}
r_* \equiv H_n R_*.
\end{equation}
To convert between $r_*$ and the source duration by Giombi et al.,
we define the source lifetime multiplier $\lambda$ as
\begin{equation}
\frac{\Delta \eta}{\eta_*} = \lambda \frac{2 r_*}{\sqrt{K}}.
\end{equation}
We define the source lifetime factor $\Lambda$
\cite[eq. 3.13]{giombi_cs_2024}
\begin{equation}
\Lambda \equiv \frac{1}{1 + 2\nu} \left(1 - \left(1 + \frac{\Delta \eta}{\eta_*} \right) \right)^{-1-2\nu},
\end{equation}
where $\nu = \nu_\text{gdh2024}$ of eq. \eqref{eq:nu_gdh2024}.
With this we can describe the corrected spectral density by Giombi et al. simply as
\begin{equation}
\tilde{P}_\text{gw,corr.}(k)
\equiv \Lambda \tilde{P}_\text{gw}(k)
\end{equation}
% 3 \Gamma^2

Another thing that we need to take into account is that the Sound Shell Model is an approximation even for the bag model,
and to get more accurate results,
we need to apply a suppression factor $\Sigma(v_\text{w},\alpha_n)$ derived from comparing Sound Shell Model results to 3D hydrodynamic simulations,
\cite[eq. 2.9]{gowling_lisa_2021}
\begin{equation}
\Omega_\text{gw}(z) = \Omega_\text{gw}^\text{ssm}(z) \Sigma(v_\text{w},\alpha_n),
\end{equation}
where $\Omega_\text{gw}^\text{ssm}(z)$ is the Sound Shell Model prediction from eq. \eqref{eq:gw_pow_spec3}.
The results in ch. \ref{ch:results} implement both the source lifetime factor $\Lambda$ and the suppression factor $\Sigma$.


\section{Gravitational wave power spectra today}
\label{omgw0}
Inserting the result \eqref{eq:pow_v} from the Sound Shell Model to eq. \eqref{eq:gw_pow_spec3} gives the gravitational wave spectrum $\mathcal{P}_\text{gw}(k)$.
In this section we convert this to the gravitational wave spectrum today, $\Omega_{\text{gw},0}$, which is an observable quantity.
The power attenuation following the end of the radiation era is given by
\cites[eq. 2.11]{gowling_lisa_2021}[eq. 19]{caprini_detecting_2020}
\footnote{In \cite[eq. 2.11]{gowling_lisa_2021} the $\frac{4}{9}$ is a typo and should be $\frac{4}{3}$ as in \cite[eq. 19]{caprini_detecting_2020}.}
\begin{equation}
F_{\text{gw},0} = \Omega_{\gamma,0} \left( \frac{g_{s0}}{g_{s*}} \right)^\frac{4}{3} \frac{g_*}{g_0}.
\end{equation}
Here the density parameter of photons today, $\Omega_{\gamma,0} \approx 1.0995 \cdot 10^{-4}$.
The degrees of freedom today are $g_0 = 2, g_{s0} \approx 3.91$.
In the Standard Model $g_{s*} = g_*$ for $T > 0.1 \text{MeV}$,
and in PTtools these can be extracted from the given equation of state or specified by the user.
The Hubble rate at the phase transition redshifted to today is given by
\cites[eq. 2.13]{gowling_lisa_2021}[eq. 31]{caprini_detecting_2020}
\begin{equation}
f_{*,0} = 2.6 \cdot 10^{-6} \text{Hz} \left( \frac{T_n}{100 \text{GeV}} \right) \left( \frac{g_*}{100} \right)^\frac{1}{6}.
\end{equation}
Using this we can convert from the dimensionless wavenumber $z$ to frequency today by taking into account the redshift
\cite[eq. 2.12]{gowling_lisa_2021}
\begin{equation}
f = \frac{z}{r_*} f_{*,0}.
\end{equation}
The power spectrum today at the physical frequency f is
\cite[eq. 2.10]{gowling_lisa_2021}
\begin{equation}
\Omega_{\text{gw},0}(f) = F_{\text{gw},0} \Omega_\text{gw}(z(f)).
\end{equation}
Now we have defined the complete process from converting the fluid shell profile to the observable gravitational wave spectrum today.


\section{Instrument noise}
\label{noise}
To determine whether a phase transition can be resolved by LISA,
we need to compare its gravitational wave power spectrum to the power spectrum of the noise.
The LISA noise consists of the instrument noise and noise from the astrophysical foreground.
The most notable astrophysical noise sources are the extragalactic compact binaries and unresolved galactic compact binaries.
These have been left out from this thesis for simplicity, but are included in PTtools \cite{pttools}.
\cite{gowling_lisa_2021}

The LISA instrument noise is expected to consist primarily by two main sources: the test mass acceleration noise (acc), and the optical metrology noise (oms).
The optical metrology noise is caused by single link optical path-length fluctuations.
Their noise target for LISA is
\cites[eq. 3.2]{gowling_lisa_2021}[eq. 54]{smith_lisa_2019}
\begin{equation}
P_\text{oms} = \left( \frac{1.5 \cdot 10^{-11} \text{m}}{L} \right)^2 \text{Hz}^{-1},
\end{equation}
where $L = 2.5 \cdot 10^9 m$
\footnote{In \cite[p. 12]{gowling_lisa_2021} there is a typo in the value of $L$. This thesis uses the correct value.}
is the LISA constellation arm length.
The single test mass acceleration noise target for LISA is
\cites[eq. 3.3]{gowling_lisa_2021}[eq. 52-53]{smith_lisa_2019}
\begin{equation}
P_\text{acc} = \left( \frac{3 \cdot 10^{-15} \frac{m}{s^2}}{(2\pi f)^2 L} \right)^2 \left( 1 + \left( \frac{0.4 \text{mHz}}{f} \right)^2 \right) \text{Hz}^{-1}.
\end{equation}
The transfer frequency is the inverse of the time it takes for light to be sent between the LISA satellites,
\begin{equation}
f_t \equiv \frac{c}{2 \pi L},
\end{equation}
where $c$ is the speed of light.
The modulation caused by one round trip of a signal along a link is given by
\cite[p. 12]{gowling_lisa_2021}
\begin{equation}
W(f,f_t) = 1 - \exp \left( \frac{-2if}{f_t} \right).
\end{equation}
Using these we can express the instrument noise in the A and E channels of LISA as
\cites[eq. 3.4]{gowling_lisa_2021}[eq. 57]{smith_lisa_2019}
\begin{equation}
N_A = N_E = \left(
\left(4 + 2 \cos \left( \frac{f}{f_t} \right) \right) P_\text{oms} +
8 \left( 1 + \cos \left( \frac{f}{f_t} \right) + \cos^2 \left( \frac{f}{f_t} \right) \right) P_\text{acc}
\right) |W|^2.
\end{equation}
The gravitational wave response function for the A and E channels is known only numerically, but can be approximated as
\cites[eq. 3.6]{gowling_lisa_2021}[eq. 32]{smith_lisa_2019}
\begin{equation}
\mathcal{R}_A^\text{Fit} = \mathcal{R}_E^\text{Fit} \approx \frac{9}{20} |W|^2 \left( 1 + \left( \frac{3f}{4f_t} \right)^2 \right)^{-1}.
\end{equation}

The noise power spectral density (PSD) is defined as
\cite[eq. 3.1]{gowling_lisa_2021}
\begin{equation}
S(f) \equiv \frac{N(f)}{\mathcal{R}(f)}.
\end{equation}
This can be converted to the fractional energy density power spectrum with
\cites[eq. 3.8]{gowling_lisa_2021}[eq. 59]{smith_lisa_2019}
\begin{equation}
\Omega_\text{ins} = \left( \frac{4 \pi^2}{3 H_0^2} \right) f^3 S_A(f)
\end{equation}
Now that we know the power spectra for both the GW signal and noise, we can compute the signal-to-noise ratio can be computed with
\cites[eq. 50]{smith_lisa_2019}[eq. 33]{caprini_detecting_2020}
\begin{equation}
\text{SNR} = \sqrt{t_\text{meas} \int_{f_\text{min}}^{f_\text{max}} df \frac{\Omega_\text{signal}(f)^2}{\Omega_\text{noise}(f)^2}},
\end{equation}
where $t_\text{meas}$ is the total measurement time.
Now we have the means to determine whether a phase transition with a particular fluid profile can be detected by LISA.
